{% extends "base.html" %}
{% load static %}
{% block title %}AdminFeedBack{% endblock %}

{% block content %}
<div style="max-width:900px; margin:30px auto; background:#fff; border-radius:15px; padding:25px; box-shadow:0 4px 14px rgba(0,0,0,0.1);">
  <h2 style="text-align:center; color:#004080; margin-bottom:20px;">ðŸ“¬ Foydalanuvchilar Takliflari</h2>

  {% if messages %}
    {% for m in messages %}
      <div style="background:#f8fbff; padding:10px; border-radius:8px; text-align:center; margin-bottom:10px;">
        {{ m }}
      </div>
    {% endfor %}
  {% endif %}

  <div class="table-container">
    <table class="feedback-table">
      <thead>
        <tr>
          <th>Ism Familiya</th>
          <th>Telefon</th>
          <th>Taklif</th>
          <th>Sana</th>
        </tr>
      </thead>
      <tbody>
        {% if not feedbacks %}
          <tr>
            <td colspan="4" style="text-align:center; padding:20px; color:#777;">Takliflar mavjud emas</td>
          </tr>
        {% else %}
          {% for f in feedbacks %}
            <tr>
              <td data-label="Ism Familiya">{{ f.full_name }}</td>
              <td data-label="Telefon">{{ f.phone|default:"" }}</td>
              <td data-label="Taklif">{{ f.message|default:""|truncatechars:13 }}</td>
              <td data-label="Sana">{{ f.created_at|date:"d.m.Y H:i" }}</td>
            </tr>
          {% endfor %}
        {% endif %}
      </tbody>
    </table>
  </div>

  <div style="display:flex; justify-content:center; flex-wrap:wrap; gap:15px; margin-top:25px;">
    <a href="/Home/ExportToPdf"
       style="background:#004080; color:#fff; padding:10px 18px; border:none; border-radius:8px; text-decoration:none; font-weight:bold; transition:0.3s;">
      <i class="fa-solid fa-file-pdf"></i> PDF ga yuklash
    </a>

    <form method="post" action="/Home/ClearAllFeedBack"
          onsubmit="return confirm('Barcha takliflarni oâ€˜chirishni istaysizmi?')" style="margin:0;">
      {% csrf_token %}
      <button type="submit"
              style="background:#d32f2f; color:#fff; padding:10px 18px; border:none; border-radius:8px; cursor:pointer; font-weight:bold; transition:0.3s;">
        <i class="fa-solid fa-trash-can"></i> Tozalash
      </button>
    </form>
  </div>
</div>

<style>
  .feedback-table { width: 100%; border-collapse: collapse; font-family: Arial; }
  .feedback-table th, .feedback-table td { padding: 10px; text-align: left; border-bottom: 1px solid #eee; }
  .feedback-table thead { background: #004080; color: white; }
  .feedback-table tbody tr:hover { background-color: #f8fbff; transition: 0.2s; }

  @media (max-width: 768px) {
    .feedback-table thead { display: none; }
    .feedback-table, .feedback-table tbody, .feedback-table tr, .feedback-table td { display: block; width: 100%; }
    .feedback-table tr {
      margin-bottom: 15px; background: #f8fbff; border-radius: 10px; padding: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    .feedback-table td { text-align: right; padding-left: 50%; position: relative; }
    .feedback-table td::before {
      content: attr(data-label); position: absolute; left: 15px; width: 45%;
      padding-left: 10px; font-weight: bold; color: #004080; text-align: left;
    }
  }
  a:hover, button:hover { transform: scale(1.03); }
</style>
{% endblock %}
